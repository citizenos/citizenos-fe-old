<div id="topics_admin_root">

    <div class="timeline">

        <div class="milestones_wrap">

            <div class="milestones_section">
                <div class="table_cell milestones_checkmark">
                    <div class="sprite sprite-check-timeline-gray2x">
                    </div>
                </div>
                <div class="table_cell">
                    <div class="bold" translate="VIEWS.TOPICS_TOPICID.BAR_MILESTONES" translate-values="{count: (topic.status==STATUSES.voting ? 1 :  topic.status==STATUSES.followUp ? 2: 0)}"> 0
                        MILESTONES
                    </div>
                </div>
            </div>

        </div>

        <div class="table_cell">
            <div class="background_line timeline_gray_background">
            </div>

            <div ng-if="[STATUSES.closed, STATUSES.followUp].indexOf(topic.status) > -1" class="progress_line bar_blue follow_up_line"
                 ng-class="{in_follow_up_line: STATUSES.followUp === topic.status}">
            </div>

            <div ng-if="[STATUSES.closed, STATUSES.followUp, STATUSES.voting].indexOf(topic.status) > -1" class="progress_line voting_line bar_green"
                ng-class="{in_voting_line: STATUSES.voting === topic.status}">
            </div>

            <div ng-if="[STATUSES.closed, STATUSES.followUp, STATUSES.voting, STATUSES.inProgress].indexOf(topic.status) > -1" class="progress_line pin_yellow_background progress_status_line"
                ng-class="{in_progress_line: STATUSES.inProgress === topic.status}">
            </div>

            <div class="days_left_wrap"
                 ng-class="{'pin_yellow_background days_left_in_progress': topic.status === STATUSES.inProgress,
                    'bar_green days_left_voting': topic.status === STATUSES.voting,
                    'bar_blue days_left_follow_up': topic.status === STATUSES.followUp,
                    'timeline_gray_background days_left_closed': topic.status === STATUSES.closed,
                 }">
                <div class="table_cell">
                    {{'TXT_TOPIC_STATUS_' + topic.status | uppercase | translate}}
                </div>
            </div>

            <div class="checkmark">
                <div class="table_cell">
                    <div class="sprite sprite-check-timeline-yellow-start2x">
                    </div>
                </div>
            </div>

            <div ng-if="[STATUSES.closed, STATUSES.followUp, STATUSES.voting].indexOf(topic.status) > -1" class="checkmark checkmark_in_progress">
                <div class="table_cell">
                    <div class="sprite sprite-check-timeline-yellow2x">
                    </div>
                </div>
                <div class="tooltip">
                    <span translate="VIEWS.TOPICS_TOPICID.BAR_TOOLTIP_PHASE">Phase:</span> <span class="bold" translate="VIEWS.TOPICS_TOPICID.BAR_TOOLTIP_IN_PROGRESS">In progress</span>
                </div>
            </div>

            <div ng-if="[STATUSES.closed, STATUSES.followUp].indexOf(topic.status) > -1" class="checkmark checkmark_voting">
                <div class="table_cell">
                    <div class="sprite sprite-check-timeline-green2x">
                    </div>
                </div>
                <div class="tooltip">
                    <span translate="VIEWS.TOPICS_TOPICID.BAR_TOOLTIP_PHASE">Phase:</span> <span class="bold" translate="VIEWS.TOPICS_TOPICID.BAR_TOOLTIP_VOTING">Voting</span>
                </div>
            </div>

        </div>

        <div class="additional_info signing_deadline" ng-if="topic.vote.endsAt">
            <span translate="VIEWS.TOPICS_TOPICID.BAR_SIGNING_DEADLINE">Signing deadline</span> <span class="bold">{{topic.vote.endsAt | amDateFormat:'L'}}</span>
        </div>


        <div class="additional_info current_phase">
            <span translate="VIEWS.TOPICS_TOPICID.BAR_CURRENT_PHASE">Current phase:</span> {{'TXT_TOPIC_STATUS_' + topic.status | uppercase | translate}}
        </div>
    </div>

    <div class="content_wrap">

        <div class="tabs_wrap_wrap">

            <div class="tabs_wrap">
                <div class="tabs_visible_area" ng-controller="buttonsSlider">
                    <div ng-if="trainPosition != 0 && tabsTrainWidth > tabsVisibleAreaWidth && wWidth > 1024" class="arrow_btn" ng-click="moveLeft()">
                        <div class="table_cell">
                            <div class="sprite sprite-icon-arrow-topic-tab2x"></div>
                        </div>
                    </div>
                    <div ng-if="trainPosition >= -tabsTrainWidth+tabsVisibleAreaWidth && wWidth > 1024" class="arrow_btn right" ng-click="moveRight()">
                        <div class="table_cell">
                            <div class="sprite sprite-icon-arrow-right-topic-tab2x"></div>
                        </div>
                    </div>
                    <div class="tabs_rails">
                        <div class="tabs_train" slide-controller identifier="tabsTrain" dimensions >
                            <div class="tab" ui-sref="topics.view({topicId: topic.id})" ui-sref-opts="{reload: true}" ng-class="{selected: ('topics.view' | isState)}"
                                dimensions>
                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.TAB_VIEW">View</div>
                            </div>
                            <div ng-if="topic.voteId || topic.vote && topic.vote.id" class="tab" ui-sref="topics.view.votes.view({topicId: topic.id, voteId:topic.voteId})"
                                 ui-sref-opts="{reload: true}" ng-class="{selected: ('topics.view.votes.view' | isState)}" dimensions>
                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.TAB_VOTE">Vote</div>
                            </div>
                            <div ng-if="[STATUSES.closed, STATUSES.followUp].indexOf(topic.status) > -1" class="tab" ui-sref="topics.view.followUp({topicId: topic.id})"
                                 ui-sref-opts="{reload: true}" ng-class="{selected: ('topics.view.followUp' | isState)}" dimensions>
                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.TAB_FOLLOW_UP">Follow up</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="fake_cell"></div>

            <div class="line lightest_line"></div>


        </div>

        <div class="content">
            <div class="main_panel">
                <div class="info_bar_wrap" ng-if="app.editMode && showInfoEdit && topic.canEditDescription()">
                    <div class="info_bar bar_blue info_bar_show">
                        <div class="info_icon">
                            <div class="sprite sprite-icon-notification-info2x"></div>
                        </div>

                        <div class="info_bar_text">
                            <div class="info_row">
                                <span translate="VIEWS.TOPICS_TOPICID.TAB_INFO_TXT_EDIT">You are now in edit mode. You can add text or make changes to it</span>
                            </div>
                        </div>

                        <div class="info_icon" ng-click="hideInfoEdit()">
                            <div class="sprite sprite-icon-closemenu2x"></div>
                        </div>
                    </div>
                </div>

                <div class="info_bar_wrap" ng-if="topic.canEdit() && (topic.status === STATUSES.voting) && !('topics.view.votes' | includedByState)">
                    <div class="info_bar bar_green info_bar_show">
                        <div class="info_icon">
                            <div class="sprite sprite-icon-notification-check2x"></div>
                        </div>

                        <div class="info_bar_text">
                            <div class="info_row">
                                <span translate="VIEWS.TOPICS_TOPICID.TAB_INFO_TXT_VOTE">This topic is being voted on, editing is no longer possible!</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Show this in 2 cases - topic has been moderated OR topic has been reported && User is a moderator -->
                <!-- topic.report.type is returned for Moderators only -->
                <!-- topic.report.moderatedReasonType is returned in case Topic has been moderated -->
                <div class="info_bar_wrap" ng-if="topic.report.moderatedReasonType || (topic.report.type && !topic.report.moderatedReasonType)">
                    <div class="info_bar bar_red info_bar_show">
                        <div class="info_icon">
                            <div class="sprite sprite-icon-notification-info2x"></div>
                        </div>

                        <div class="info_bar_text">
                            <div class="info_row">
                                <span translate="VIEWS.TOPICS_TOPICID.TAB_INFO_TXT_REPORTED">This topic has been reported.</span>&nbsp;<a ng-click="doShowReportOverlay()" href="" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_LNK_VIEW_REPORT_DETAILS">View details</a>
                                <span ng-if="topic.report.type && !topic.report.moderatedReasonType">&nbsp;<a ui-sref="topics.view.reportsModerate({topicId: topic.id, reportId: topic.report.id})" ui-sref-opts="{reload:false}" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_LNK_MODERATE">Moderate</a></span>
                                <span ng-if="topic.report.type">&nbsp;<a ui-sref="topics.view.reportsResolve({topicId: topic.id, reportId: topic.report.id})" ui-sref-opts="{reload:false}" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_LNK_RESOLVE">Mark as resolved</a></span>
                                <span ng-if="topic.canEdit() && topic.report.moderatedReasonType">&nbsp;<a ui-sref="topics.view.reportsReview({topicId: topic.id, reportId: topic.report.id})" ui-sref-opts="{reload:false}" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_LNK_SUBMIT_FOR_REVIEW">Submit for review</a></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="main_content_wrap">

                    <!-- Create a milestone -->

                    <div class="voting_platform_wrap create_a_milestone_wrap" ng-if="('topics.view.followUp' | isState) && topic.canEdit()">

                        <div class="vote_casting_header">
                            <div class="vote_casting_header_section">
                                <div class="table_cell bold" translate="VIEWS.TOPICS_TOPICID.ADD_MILESTONES_CREATE_A_MILESTONE">
                                    Create a milestone
                                </div>
                            </div>
                            <div class="clearer"></div>
                        </div>

                        <div class="line lightest_line"></div>

                        <div class="create_a_milestone_content">
                            <div class="voting_platform_section">

                                <input id="create_milestone_title" ng-model="eventForm.subject" ng-class="{'error_input': eventForm.errors.subject}" translate
                                       translate-attr-placeholder="VIEWS.TOPICS_TOPICID.ADD_MILESTONES_PLACEHOLDER_SUBJECT" class="gray_borders" maxlength="{{maxLengthSubject}}" required>
                                <label for="create_milestone_title" class="error_label" ng-if="eventForm.errors.subject">
                                    <div class="table_cell">
                                        <div class="sprite sprite-icon-inputfield-error2x"></div>
                                        <span translate="{{eventForm.errors.subject}}">Subject error</span>
                                    </div>
                                </label>

                                <textarea id="create_milestone_textarea" class="gray_borders" ng-class="{'error_input': eventForm.errors.text}" ng-model="eventForm.text" translate
                                          translate-attr-placeholder="VIEWS.TOPICS_TOPICID.ADD_MILESTONES_PLACEHOLDER_TEXT" maxlength="{{maxLengthText}}" required></textarea>

                                <label for="create_milestone_textarea" class="error_label" ng-if="eventForm.errors.text">
                                    <div class="table_cell">
                                        <div class="sprite sprite-icon-inputfield-error2x"></div>
                                        <span translate="{{eventForm.errors.text}}">Text error</span>
                                    </div>
                                </label>

                                <div class="blue_button">
                                    <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.ADD_MILESTONES_ADD_MILESTONE" ng-click="submitEvent()">
                                        ADD MILESTONE
                                    </div>
                                </div>
                            </div>

                        </div>

                    </div>


                    <div class="milestones_in_descriptions_wrap" ng-if="('topics.view.followUp' | isState)">
                        <div class="milestone_description" ng-repeat="(key, event) in topicEvents">
                            <div class="milestone_description_header">
                                <div class="table_cell">
                                    <div class="sprite sprite-check-timeline-blue2x"></div>
                                </div>
                                <div class="table_cell">
                                    <div class="milestone_number" translate="VIEWS.TOPICS_TOPICID.ADD_MILESTONES_MILESTONE" translate-values="{number: topicEvents.length - $index}">2ND MILESTONE</div>
                                </div>
                                <div class="table_cell">
                                    <div class="v_line"></div>
                                </div>
                                <div class="table_cell">
                                    <div class="milestone_date">
                                        {{event.createdAt | amDateFormat: 'LLL'}}
                                    </div>
                                </div>
                                <div class="table_cell" ng-if="topic.canEdit()">
                                    <div class="v_line"></div>
                                </div>
                                <div class="table_cell" ng-if="topic.canEdit()">
                                    <div class="milestone_action">
                                        <span class="red_text blue_link" translate="VIEWS.TOPICS_TOPICID.ADD_MILESTONE_DELETE" ng-click="deleteEvent(event)">delete</span>
                                    </div>
                                </div>
                            </div>
                            <div class="milestone_description_content">
                                <div class="milestone_description_title" ng-bind-html="event.subject">
                                    This is what we will do in our second step of our 5-year plan
                                </div>
                                <div class="milestone_description_text" ng-bind-html="event.text | linky">
                                    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an
                                    unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic
                                    typesetting, remaining essentially unchanged.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Cast your vote container-->

                    <div class="voting_platform_wrap vote_casting_wrap" ng-if="topic.vote.id && showVoteArea">

                        <div class="vote_casting_header">
                            <div class="vote_casting_header_section">
                                <div class="table_cell bold vote_casting_description" translate="VIEWS.TOPICS_TOPICID.VOTE_CAST_YOUR_VOTE">Cast your vote</div>
                            </div>
                            <div class="vote_casting_header_section">
                                <div class="table_cell">
                                    <span class="bold">{{topic.vote.getVoteCountTotal()}}</span><span ng-if="topic.visibility === VISIBILITY.private">/{{topic.members.users.count}}</span> <span
                                    translate="VIEWS.TOPICS_TOPICID.VOTE_VOTES_COUNTED"> votes counted</span>
                                </div>
                            </div>
                            <div class="clearer"></div>
                        </div>

                        <div class="line lightest_line"></div>

                        <div class="vote_casting_message with_upper_right_links" ng-if="topic.vote.authType === voteAuthTypes.hard && !topic.hasVoteEnded()">

                            <div class="message_header">
                                <div class="message_title" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_REQUIRE_HARD_ID">This vote requires an ID card or Mobile ID signing.</div>
                                <div class="float_wrap">
                                    <div class="sprite sprite-id-kaart-small2x"></div>
                                    <div class="sprite sprite-mobiil-id-small2x"></div>
                                    <div class="clearer"></div>
                                </div>
                                <div class="clearer"></div>
                            </div>

                            <div class="message_content" translate="VIEWS.TOPICS_TOPICID.VOTE_TXT_REQUIRE_HARD_ID">This document needs a signing by ID card or Mobile ID to be registered. You can not
                                vote if you don’t identify yourself.
                            </div>

                        </div>

                        <div class="vote_casting_message with_upper_right_links" ng-if="getUserHasVoted() && !topic.hasVoteEnded()">

                            <div class="message_header">
                                <div class="message_title" translate="VIEWS.TOPICS_TOPICID.HEADING_VOTE_REGISTERED">Your vote has been registered!</div>
                                <div class="float_wrap">
                                    <div class="blue_link" ng-class="{hidden: topic.vote.authType !== voteAuthTypes.hard}"><a ng-href="{{topic.vote.downloads.bdocVote}}"
                                                                                                                   translate="VIEWS.TOPICS_TOPICID.BTN_DOWNLOAD_USER_BDOC" download>Download your DDOC</a></div>
                                </div>
                                <div class="clearer"></div>
                            </div>

                            <div class="message_content" ng-class="{hidden: topic.vote.authType !== voteAuthTypes.hard}" translate="VIEWS.TOPICS_TOPICID.VOTE_TXT_VOTE_REGISTERED">This document needs a signing by
                                ID card or Mobile ID to be registered. You can not vote if you don’t identify yourself.
                            </div>

                        </div>


                        <div class="voting_platform_buttons" ng-if="!topic.hasVoteEnded()">

                            <div class="voting_button" cos-disabled="!topic.canVote()" ng-class="(option.selected) ? '' : 'active'" ng-repeat="(key, option) in topic.vote.options.rows"
                                 ng-click="doVote(option)">
                                <div class="table_cell left_side">
                                    {{getOptionLetter(key)}}.
                                </div>
                                <div class="table_cell right_side" translate="{{'VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase}}"
                                     translate-default="{{option.value | linky}}"></div>
                            </div>

                        </div>

                        <div class="delegation_section" ng-if="!topic.hasVoteEnded()">

                            <div class="voting_button voting_button_blue" cos-disabled="(!topic.canDelegate() || topic.vote.authType === voteAuthTypes.hard)"
                                 ng-class="topic.vote.delegation ? '' : 'active'" ng-click="doDelegate()">
                                <div class="table_cell left_side">
                                    <div class="sprite sprite-icon-delegate2x"></div>
                                </div>
                                <div class="table_cell right_side" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_DELEGATE">Delegate your vote</div>
                            </div>

                            <div class="delegation_information" ng-if="topic.vote.delegation">
                                <div class="delegation_title" translate="VIEWS.TOPICS_TOPICID.VOTE_DELEGATED_TO">You delegated your vote to</div>
                                <div class="delegations">

                                    <div class="table_cell">
                                        <div class="profile_image_wrapper dark">
                                            <!--div class="profile_moon sprite sprite-icon-certified-fb2x"></div-->
                                            <div class="account_picture">
                                                <img ng-if="topic.vote.delegation.imageUrl" ng-src="{{topic.vote.delegation.imageUrl}}">
                                                <div ng-if="!topic.vote.delegation.imageUrl" class="profile_image_filler">
                                                    <div class="table_cell" cos-initials="topic.vote.delegation.name | limitTo: 1">
                                                        C
                                                    </div>
                                                    <div class="profile_circle"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="name_wrap">
                                            <div class="table_cell">
                                                <div class="blue_link bold">{{topic.vote.delegation.name}}</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="table_cell">
                                        <div class="blue_button" ng-click="doRevokeDelegation()" translate="VIEWS.TOPICS_TOPICID.VOTE_REVOKE_DELEGATION">Revoke your delegation</div>
                                    </div>
                                </div>
                            </div>

                        </div>


                        <!-- Statistics graph start -->
                        <div class="vote_casting_message" ng-if="topic.canUpdate() && topic.hasVoteEnded()">

                            <div class="message_header">
                                <div class="message_title" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_VOTE_CLOSED">Voting has ended!</div>
                                <div class="clearer"></div>
                            </div>

                            <div ng-if="!topic.hasVoteEndedExpired()" class="message_content" translate="VIEWS.TOPICS_TOPICID.VOTE_TXT_VOTE_CLOSED">Everyone has cast their votes. You can download the full document here.</div>

                            <div ng-if="topic.hasVoteEndedExpired()">
                                <div class="message_content" translate="VIEWS.TOPICS_TOPICID.VOTE_TXT_VOTE_CLOSED_EXPIRED">Votes have now been cast. Please send topic to follow-up, then return here to download voting results.</div>
                                <div class="voting_button voting_button_blue active">
                                    <div class="table_cell" ng-click="sendToFollowUp('topics.view.votes.view')" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_SEND_TO_FOLLOW_UP">Send to follow</div>
                                </div>
                            </div>

                            <div class="info_box_wrap" ng-if="multipleWinners && (topic.status === STATUSES.followUp) && ('topics.view.votes.view' | isState) && showInfoWinners">
                                <div class="info_box" ng-class="{'info_box_show': multipleWinners && (topic.status === STATUSES.followUp) && ('topics.view.votes.view' | isState)}">
                                    <div class="info_icon">
                                        <div class="sprite sprite-icon-box-info2x"></div>
                                    </div>

                                    <div>
                                        <div class="info_row">
                                            <p class="info_box_heading" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_TITLE_DRAW">
                                                Looks like your voting process resulted in a draw.
                                            </p>
                                            <p class="info_bar_text" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_DRAW_DESCRIPTION">
                                                Sometimes having several winning options is a good thing, but there are times, when you just really need one clear winner.
                                            </p>
                                            <p class="info_box_heading" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_TITLE_DRAW_WHAT_NOW">
                                                Here's what you could do now:
                                            </p>
                                            <p class="info_bar_text" translate="VIEWS.TOPICS_TOPICID.TAB_INFO_TXT_DRAW_WHAT_NOW">
                                                    It might be possible to solve this offline - for example, a co-located team could flip a coin between the two winning options.
                                                    Also, if you had votes going to non-winning options, we suggest you run another vote between the two previously winning options only. This time, you could pre-determine a tie-breaker in case you have another draw: a coin flip, a default winning option (usually status quo wins in a draw), a person whose vote is decisive etc.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <a ng-if="topic.vote.authType===voteAuthTypes.hard && topic.vote.downloads.bdocFinal" ng-href="{{topic.vote.downloads.bdocFinal}}" download>
                                <div class="voting_button voting_button_blue active">
                                    <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.BTN_DOWNLOAD_FINAL_BDOC">Download full DDOC</div>
                                </div>
                            </a>
                            <a ng-if="topic.vote.authType===voteAuthTypes.soft && topic.vote.downloads.zipFinal" ng-href="{{topic.vote.downloads.zipFinal}}" download>
                                <div class="voting_button voting_button_blue active">
                                    <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.BTN_DOWNLOAD_FINAL_ZIP">Download full ZIP</div>
                                </div>
                            </a>

                        </div>

                        <!-- Regular graph -->
                        <div class="graph_wrap" ng-if="topic.vote.type === voteTypes.regular && topic.hasVoteEnded()">

                            <div class="graph_row" ng-class="option.winner ? 'active' : ''" ng-repeat="(key, option) in topic.vote.options.rows">
                                <!-- TODO: Maybe there is a better solution for translation fallback in the tooltip text? -->
                                <div class="graph_row_fill" cos-styles='{"width" : "{{getVoteValuePercentage(option.voteCount)}}%"}' tooltips
                                     tooltip-template="{{((optionTranslation = ('VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase | translate)) != ('VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase)) ? optionTranslation : (option.value | linky)}}"
                                     tooltip-smart="true">
                                    <div class="graph_row_text_wrap">
                                        <div class="table_cell">
                                            <div class="graph_row_text">
                                                <span translate="{{'VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase}}"
                                                      translate-default="{{option.value | linky}}"></span><br>
                                                <span class="bold">{{option.voteCount || 0}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- Big graph -->
                        <div class="big_graph" ng-if="topic.vote.type === voteTypes.multiple && topic.hasVoteEnded()">
                            <div class="long_text_holder">
                                <div class="long_text" ng-class="(option.winner) ? 'active' : ''" ng-repeat="(key, option) in topic.vote.options.rows">
                                    <span class="bold">{{getOptionLetter(key)}}.</span> <span translate="{{'VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase}}"
                                                                                              translate-default="{{option.value | linky}}"></span>
                                </div>
                            </div>

                            <div class="graph_wrap">
                                <div class="graph_row" ng-class="option.winner ? 'active' : ''" ng-repeat="(key, option) in topic.vote.options.rows">
                                    <!-- TODO: Maybe there is a better solution for translation fallback in the tooltip text? -->
                                    <div class="graph_row_fill" cos-styles='{"width" : "{{getVoteValuePercentage(option.voteCount)}}%"}' tooltips
                                         tooltip-template="{{((optionTranslation = ('VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase | translate)) != ('VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_' + option.value | linky | uppercase)) ? optionTranslation : (option.value | linky)}}"
                                         tooltip-smart="true">
                                        <div class="graph_row_text_wrap">
                                            <div class="table_cell">
                                                <div class="graph_row_text">
                                                    {{getOptionLetter(key)}}.<br>
                                                    <span class="bold">{{option.voteCount || 0}}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <!-- Statistics graph end -->

                    </div>

                    <div class="voting_platform_wrap" ng-if="showVoteCreateForm">
                        <div class="platform_description" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_CREATE">Create a voting platform</div>
                        <div class="voting_platform_section">
                            <div class="line lightest_line"></div>
                            <div class="voting_platform_section_title" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_STEP1">Step 1: Choose voting type</div>

                            <div class="voting_platform_buttons_wrap">

                                <div class="table_cell">
                                    <div class="voting_platform_button" ng-click="setVoteType(voteTypes.regular)" ng-class="voteForm.voteType == 'regular'? '' : 'active'">
                                        <div class="table_cell">
                                            <div class="button_title" translate="VIEWS.TOPICS_TOPICID.VOTE_BTN_TYPE_REGULAR">REGULAR</div>
                                            <div class="button_description" translate="VIEWS.TOPICS_TOPICID.VOTE_BTN_TYPE_REGULAR_EXPLANATION">(ie. yes/no/neutral/…)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="table_cell">
                                    <div class="voting_platform_button" ng-click="setVoteType(voteTypes.multiple)" ng-class="voteForm.voteType == 'multiple' ? '' : 'active'">
                                        <div class="table_cell">
                                            <div class="button_title" translate="VIEWS.TOPICS_TOPICID.VOTE_BTN_TYPE_MULTIPLECHOICE">MULTIPLECHOICE</div>
                                            <div class="button_description" translate="VIEWS.TOPICS_TOPICID.VOTE_BTN_TYPE_MULTIPLECHOICE_EXPLANATION">(ie. A/B/C/D/…)</div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="clearer"></div>

                        </div>

                        <div class="line lightest_line"></div>

                        <div class="voting_platform_section" ng-if="voteForm.voteType">
                            <div class="voting_platform_section_title" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_STEP2">Step 2: Define answers</div>

                            <!-- regular -->
                            <div class="define_answers_wrap" ng-if="voteForm.voteType == 'regular'">
                                <div class="table_cell">
                                    <div class="table">
                                        <div class="table_cell">
                                            <div class="gray_toggle_box">
                                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_YES">Yes</div>
                                                <div class="table_cell">
                                                    <div cos-disabled="true" cos-toggle ng-model="voteForm.options[0].enabled" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                         cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="table_cell">
                                            <div class="gray_toggle_box">
                                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_NO">No</div>
                                                <div class="table_cell">
                                                    <div cos-disabled="true" cos-toggle ng-model="voteForm.options[1].enabled" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                         cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="table_cell">
                                    <div class="table">
                                        <div class="table_cell">
                                            <div class="gray_toggle_box">
                                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_NEUTRAL">Neutral</div>
                                                <div class="table_cell">
                                                    <div cos-toggle ng-model="voteForm.extraOptions.neutral.enabled" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                         cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="table_cell">
                                            <div class="gray_toggle_box">
                                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_VETO">Veto</div>
                                                <div class="table_cell">
                                                    <div cos-toggle ng-model="voteForm.extraOptions.veto.enabled" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                         cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- multiplechoice -->
                            <div class="double_cell_layout" ng-if="voteForm.voteType == 'multiple'">
                                <div class="left_row">

                                    <div class="input_with_icon clickable" ng-repeat="(key, option) in voteForm.options">
                                        <input id="{{'voteOption' + $index}}" class="gray_borders" ng-model="option.value" ng-class="{'error_input': option.value && voteForm.errors.value}" placeholder="{{'VIEWS.TOPICS_TOPICID.PLACEHOLDER_ENTER_A_POSSIBLE_ANSWER' | translate}}">
                                        <div class="icon_table" ng-class="{'error': option.value && voteForm.errors.value}">
                                            <div class="icon_cell" ng-click="removeOption(key)">
                                                <div class="sprite sprite-inputfield-icon-delete2x"></div>
                                            </div>
                                        </div>
                                        <label for="{{'voteOption' + $index}}" class="error_label" ng-if="option.value && voteForm.errors.value">
                                            <div class="table_cell">
                                                <div class="sprite sprite-icon-inputfield-error2x"></div>
                                                <span translate="{{voteForm.errors.value}}"></span>
                                            </div>
                                        </label>
                                    </div>

                                    <div class="blue_button" ng-click="addOption()" translate="VIEWS.TOPICS_TOPICID.VOTE_BTB_ADD_OPTION">Add another answer</div>
                                </div>
                                <div class="right_row add_bottom_borders">

                                    <div class="gray_toggle_box">
                                        <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_NEUTRAL">Neutral</div>
                                        <div class="table_cell">
                                            <div cos-toggle ng-model="voteForm.extraOptions.neutral.enabled" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                 cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                        </div>
                                    </div>

                                    <div class="gray_toggle_box">
                                        <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_OPTION_VETO">Veto</div>
                                        <div class="table_cell">
                                            <div cos-toggle ng-model="voteForm.extraOptions.veto.enabled" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                 cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                        </div>

                        <div class="line lightest_line" ng-if="voteForm.voteType"></div>


                        <div class="voting_platform_section" ng-if="voteForm.voteType">
                            <div class="voting_platform_section_title" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_STEP3">Step 3: User vote casting</div>

                            <div class="double_cell_layout ten_px_margin_between">
                                <div class="left_row add_bottom_borders">

                                    <div class="gray_toggle_box">
                                        <div class="table_cell">
                                            <div class="toggle_box_title" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_AUTH_SOFT_ID">Soft-ID</div>
                                            <div class="toggle_box_description" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_AUTH_SOFT_ID_EXPLANATION">CITIZENOS LOGIN IS REQUIRED</div>
                                        </div>
                                        <div class="table_cell">
                                            <div cos-toggle ng-value="voteAuthTypes.soft" off-value="voteAuthTypes.hard" ng-model="voteForm.authType" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                 cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                        </div>
                                    </div>

                                    <div class="gray_toggle_box">
                                        <div class="table_cell">
                                            <div class="toggle_box_title" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_AUTH_HARD_ID">Hard-ID</div>
                                            <div class="toggle_box_description" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_AUTH_HARD_ID_EXPLANATION">ID-CARD OR MOBILE ID SIGNING IS REQUIRED</div>
                                        </div>
                                        <div class="table_cell">
                                            <div cos-toggle ng-value="voteAuthTypes.hard" off-value="voteAuthTypes.soft" ng-model="voteForm.authType" cos-toggle-text-on="'TOGGLE_ON' | translate"
                                                 cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                        </div>
                                        <div class="table_row">
                                            <div class="float_wrap">
                                                <div class="sprite sprite-id-kaart-small2x"></div>
                                                <div class="sprite sprite-mobiil-id-small2x"></div>
                                                <div class="clearer"></div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <div class="right_row add_bottom_borders">

                                    <div class="gray_toggle_box">
                                        <div class="table_cell">
                                            <div class="toggle_box_title" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_DELEGATION">Delegation</div>
                                            <div class="toggle_box_description" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_DELEGATION_EXPLANATION">ALLOW USERS TO PASS ON THEIR VOTING RIGHT.</div>
                                        </div>
                                        <div class="table_cell">
                                            <div cos-toggle cos-disabled="(voteForm.authType == voteAuthTypes.hard)" ng-model="voteForm.delegationIsAllowed"
                                                 cos-toggle-text-on="'TOGGLE_ON' | translate" cos-toggle-text-off="'TOGGLE_OFF' | translate"></div>
                                        </div>
                                    </div>

                                    <div class="gray_toggle_box" ng-if="(voteForm.authType == voteAuthTypes.hard)">
                                        <div class="toggle_box_warning">
                                            <div class="sprite sprite-icon-inputfield-error2x"></div>
                                        <span
                                            translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_NOTICE_DELEGATION_DISABLED_FOR_HARD_ID">When Hard-ID is the chosen method of voting, delegation is not allowed.</span>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>


                        <div class="line lightest_line" ng-if="voteForm.voteType"></div>

                        <div class="voting_platform_section" ng-if="voteForm.voteType">
                            <div class="voting_platform_section_title" translate="VIEWS.TOPICS_TOPICID.VOTE_HEADING_STEP4">Step 4: End of voting system</div>

                            <div class="double_cell_layout ten_px_margin_between margin_betwen_boxes">

                                <div class="left_row add_bottom_borders">
                                    <div class="picker_content" ng-class="voteForm.endsAt ? 'active' : ''">

                                        <div class="bubble_content">

                                            <div class="bubble_section">

                                                <div class="gray_toggle_box">
                                                    <div class="table_cell">
                                                        <div class="toggle_box_title" translate="VIEWS.TOPICS_TOPICID.VOTE_LBL_DEADLINE">Deadline</div>
                                                    </div>
                                                    <div class="table_cell">
                                                        <div cos-toggle ng-model="voteForm.endsAt" cos-toggle-text-on="'TOGGLE_ON' | translate" cos-toggle-text-off="'TOGGLE_OFF' | translate" cos-toggle-datepicker-toggle="true"></div>
                                                    </div>
                                                </div>

                                                <div class="bubble_description">
                                                    <div class="picker_deadline_date">
                                                        {{voteForm.endsAt | amDateFormat:'L'}}
                                                    </div>
                                                    <div class="picker_days_left" translate="VIEWS.TOPICS_TOPICID.VOTE_TXT_DEADLINE_CALENDAR_DAYS_LEFT"
                                                         translate-values="{numberOfDaysLeft: daysToVoteEnd()}">0 days left
                                                    </div>
                                                    <div class="clearer"></div>
                                                </div>
                                            </div>

                                            <div class="date_picker_wrap" date-picker="voteForm.endsAt" min-date="datePickerMin" max-view="date" min-view="date"
                                                 template="/views/directives/date_picker.html"></div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="line lightest_line" ng-if="voteForm.voteType"></div>

                        <div class="voting_platform_section" ng-if="voteForm.voteType">

                            <div class="blue_button aqua_marine_background black_text" ng-click="createVote()">
                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.VOTE_BTN_CREATE_VOTE">CREATE VOTING SYSTEM</div>
                            </div>

                        </div>


                    </div>

                    <div class="iframe_content_wrap" ng-if="!('topics.view.followUp' | isState)">

                        <div class="topic_info" ng-class="app.more_info_button ? 'open' : ''">

                            <div class="container_report" ng-if="topic.visibility === VISIBILITY.public && !topic.report" ui-sref="topics.view.report">
                                <div class="ff_table_fix" tooltips tooltip-side="left" tooltip-template="<span translate='MODALS.TOOLTIP_REPORT_TOPIC'>Report topic</span>">
                                    <div class="table_cell">
                                        <div class="sprite sprite-icon-exclamation2x-white"></div>
                                        <div class="red_bg"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="container_pin" ng-class="topic.pinned ? 'pinned' : ''" ng-click="togglePin()">
                                <div class="ff_table_fix" tooltips tooltip-side="left" tooltip-template="<span translate='MODALS.TOOLTIP_PIN_TOPIC'>Pin topic</span>">
                                    <div class="table_cell">
                                        <div class="sprite sprite-icon-favourite2x-white"></div>
                                        <div class="yellow_bg"></div>
                                    </div>
                                </div>
                            </div>

                            <div class="more_info_button" ng-click="app.more_info_button = !app.more_info_button">

                                <div class="table_cell">
                                    <div class="more_info_button_text_wrap">
                                        <div class="arrow_down_wrap">
                                            <div class="arrow_down_blue sprite sprite-dropdown-arrowdown-blue2x"></div>
                                        </div>
                                        <span translate="VIEWS.TOPICS_TOPICID.LNK_TOPIC_DETAILS">Topic details</span>
                                    </div>
                                    <div class="more_info_attachment_wrap">
                                        <div class="more_info_attachment_icon sprite sprite-icon-attachment"></div>
                                        <span class="more_info_attachment_count">{{topicAttachments.length}}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="info_sections_wrap" ng-if="wWidth > 767 || app.more_info_button">
                                <div class="info_section">
                                    <div class="info_section_title">
                                        <span translate="VIEWS.TOPICS_TOPICID.LBL_CATEGORIES">Categories:</span>
                                    </div>
                                    <div class="info_section_content">
                                        <span ng-repeat="category in topic.categories">
                                            <span translate="{{'TXT_TOPIC_CATEGORY_' + category | uppercase}}" translate-default="{{category}}">Poliitika</span>
                                            <span ng-if="!$last" class="info_section_separator"> | </span>
                                        </span>
                                        <span ng-if="!topic.categories.length" translate="VIEWS.TOPICS_TOPICID.LBL_NO_CATEGORIES">none
                                            <span ng-if="topic.canEdit()" class="blue_link" ui-sref="topics.view.settings({topicId: topic.id, tab: 'categories'})" translate="VIEWS.TOPICS_TOPICID.LNK_ADD_CATEGORIES">add categories</span>
                                        </span>
                                    </div>
                                </div>
                                <div class="info_section">
                                    <div class="info_section_title">
                                        <span translate="VIEWS.TOPICS_TOPICID.LBL_AUTHORS">Authors:</span>
                                    </div>
                                    <div class="info_section_content"><span ng-if="topic.creator.email" class="blue_link"
                                    tooltips tooltip-class="tooltip_author"
                                    tooltip-template="<span class='creator_data_tooltip_row'>{{topic.creator.email}}</span><span class='creator_data_tooltip_row'>{{topic.creator.phoneNumber}}</span><span class='creator_data_tooltip_row'>{{topic.creator.pid}}</span>"
                                    tooltip-smart="true">{{topic.creator.name}}</span><span ng-if="!topic.creator.email">{{topic.creator.name}}</span>
                                    </div>
                                </div>
                                <div class="info_section">
                                    <div class="info_section_title">
                                        <span translate="VIEWS.TOPICS_TOPICID.LBL_ACTIVITY">Activity:</span>
                                    </div>
                                    <div class="info_section_content">
                                        <span class="blue_link" ng-click="app.activeCommentSection = 'arguments'; app.scrollToAnchor('arguments')"
                                                translate="VIEWS.TOPICS_TOPICID.LNK_ARGUMENTS_COUNT"
                                                translate-values="{count: topic.comments.count.total || 0}">0 arguments</span>
                                        <span class="info_section_separator"> | </span>
                                        <span class="blue_link" ng-click="app.activeCommentSection = 'socialMentions'; app.scrollToAnchor('socialMentions')" translate="VIEWS.TOPICS_TOPICID.LNK_MENTIONS_COUNT"
                                                translate-values="{mentionsCount: (topicSocialMentions.length ||0)}">0 social mentions</span>
                                                <span ng-if="!topic.hashtag && topic.canEdit()" class="info_section_separator"> | </span>
                                                <span class="blue_link" ng-if="!topic.hashtag && topic.canEdit()"
                                                    ui-sref="topics.view.settings({topicId: topic.id, tab: 'settings'})"
                                                    translate="VIEWS.TOPICS_TOPICID.LNK_MENTIONS_COUNT_ADD_HASHTAG"> add hashtag</span>
                                        <span ng-if="topic.hashtag" class="black_text"> #{{topic.hashtag}}</span>
                                    </div>
                                </div>
                                <div class="info_section" ng-if="wWidth < 767">
                                    <div class="info_section_title">
                                        <span translate="VIEWS.TOPICS_TOPICID.LBL_ATTACHMENTS">Attachments:</span>
                                    </div>
                                    <div class="info_section_content">
                                        <div class="blue_link" ng-repeat="attachment in topicAttachments">
                                            <a ng-if="attachment.source === ATTACHMENT_SOURCES.upload" class="blue_link info_section_attachment" ng-click="$event.preventDefault(); downloadAttachment(attachment);" href="{{attachment.link}}">{{attachment.name}}<span class="btn blue_button file_type">.{{attachment.type}}</span></a>
                                            <a ng-if="attachment.source !== ATTACHMENT_SOURCES.upload" class="blue_link info_section_attachment" href="{{attachment.link}}" >{{attachment.name}} <span class="btn blue_button file_type">{{attachment.type}}</span></a>
                                        </div>
                                        <div ui-sref="topics.view.files" cos-disabled="!topic.canEdit()"class="blue_link info_section_add_attachments" translate="VIEWS.TOPICS_TOPICID.LNK_ADD_MANAGE_FILES">Add/manage files</div>
                                    </div>
                                </div>
                            </div>

                            <div class="line lightest_line"></div>
                        </div>


                        <div id="topic_content_area" class="topic_content">
                            <iframe cos-etherpad ng-if="!hideTopicContent && topic.canEdit() && app.editMode" frameborder="0" scrolling="no" ng-class="{hidden: !topic.padUrl || ('topics.view.followUp' | isState)}"
                                    ng-src="{{topic.padUrl}}" width="100%" height="600"></iframe>
                            <ng-bind-html ng-if="!hideTopicContent && !app.editMode" ng-bind-html="topic.description"></ng-bind-html>
                            <h1 ng-if="hideTopicContent"><i>Topic content has been hidden due to violation of community guidelines</i></h1>
                        </div>

                    </div>

                    <div class="comments_section">
                        <div class="tabs_wrap">
                            <div ng-click="app.activeCommentSection = 'arguments'" class="tab"
                                 ng-class="app.activeCommentSection == 'arguments' || app.activeCommentSection == undefined ? 'active':''">
                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.LBL_TAB_ARGUMENTS">Arguments</div>
                            </div>
                            <div ng-click="app.activeCommentSection = 'socialMentions'" class="tab" ng-class="app.activeCommentSection == 'socialMentions' ? 'active':''">
                                <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.LBL_TAB_MENTIONS">Social mentions</div>
                            </div>
                        </div>
                        <div class="clearer"></div>
                        <div class="comments_content">
                            <div ng-if="app.activeCommentSection == 'arguments' || app.activeCommentSection == undefined" ng-include="'views/topics_topicId_comments.html'"></div>

                            <div ng-if="app.activeCommentSection == 'socialMentions'" ng-include="'views/topics_topicId_mentions.html'"></div>
                        </div>
                    </div>

                </div>

            </div>

            <div class="side_panel" ng-if="wWidth > 1024 || app.topics_settings">
                <div ng-if="topic.canEdit() && app.editMode" class="options_wrap">
                    <div class="blue_button" translate="VIEWS.TOPICS_TOPICID.NAV_BTN_DONE_EDITING" ng-click="app.doToggleEditMode()">Done editing</div>
                </div>
                <div ng-if="topic.canEdit() && topic.report.moderatedReasonType" class="options_wrap">
                    <div class="blue_button" ui-sref="topics.view.reportsReview({topicId: topic.id, reportId: topic.report.id})" ui-sref-opts="{reload:false}" translate="VIEWS.TOPICS_TOPICID.NAV_BTN_SUBMIT_FOR_REVIEW">Submit for review</div>
                </div>
                <div class="options_wrap">
                    <div class="options_header">
                        <div class="table_cell" translate="VIEWS.TOPICS_TOPICID.NAV_HEADING">OPTIONS</div>
                    </div>
                    <div class="options_content">
                        <div ng-if="!(topic.vote.id && topic.status===STATUSES.voting)" class="blue_link" cos-disabled="!topic.canSendToVote()" ng-click="sendToVote()"
                             translate="VIEWS.TOPICS_TOPICID.NAV_LNK_SEND_TO_VOTE">Send to vote
                        </div>
                        <div ng-if="(topic.vote.id && topic.status===STATUSES.voting)" class="blue_link" cos-disabled="!topic.canSendToFollowUp()" ng-click="sendToFollowUp()"
                             translate="VIEWS.TOPICS_TOPICID.NAV_LNK_SEND_TO_FOLLOW_UP">Send to follow up
                        </div>
                        <div class="blue_link" cos-disabled="!topic.canUpdate()" ng-click="closeTopic()" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_CLOSE_TOPIC">Close topic</div>
                        <div class="line lightest_line"></div>
                        <div class="blue_link" ui-sref="topics.view.settings({topicId: topic.id, tab: 'settings'})" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_SETTINGS">Settings</div>
                        <div class="blue_link" ui-sref="topics.view.settings({topicId: topic.id, tab: 'categories'})" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_CATEGORIES">Categories</div>
                        <div class="blue_link" ui-sref="topics.view.settings({topicId: topic.id, tab: 'invite'})" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_INVITE_USERS">Invite users</div>
                        <div class="blue_link" ui-sref="topics.view.settings({topicId: topic.id, tab: 'share'})" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_SHARE">Share topic</div>
                        <div ng-if="topic.visibility === VISIBILITY.public && !topic.report" class="blue_link" ui-sref="topics.view.report" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_REPORT">Report topic</div>
                        <div class="line lightest_line"></div>
                        <div class="blue_link" cos-disabled="!topic.canEditDescription()" ng-click="app.doToggleEditMode()"
                             ng-if="!app.editMode" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_EDIT_TOPIC">Edit topic
                        </div>
                        <div class="blue_link" ng-if="app.editMode" ng-click="app.doToggleEditMode()" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_VIEW_TOPIC">Edit topic</div>
                        <div cos-disabled="!topic.canLeave()" class="blue_link" ng-click="doLeaveTopic(topic)" translate="VIEWS.TOPICS_TOPICID.NAV_LNK_LEAVE_TOPIC">Leave topic</div>
                    </div>
                </div>
                <div class="options_wrap" ng-if="wWidth > 767">
                    <div class="options_header">
                        <div class="table_cell"><span translate="VIEWS.TOPICS_TOPICID.HEADER_FILES">FILES</span><span> ({{topicAttachments.length}}/{{app.config.attachments.limit}})</span></div>
                    </div>
                    <div class="options_content">
                        <div class="blue_link" ng-repeat="attachment in topicAttachments">
                            <a ng-if="attachment.source === ATTACHMENT_SOURCES.upload" class="blue_link" ng-click="$event.preventDefault(); downloadAttachment(attachment);" href="{{attachment.link}}">{{attachment.name}}<span class="btn blue_button file_type">.{{attachment.type}}</span></a>
                            <a ng-if="attachment.source !== ATTACHMENT_SOURCES.upload" class="blue_link" href="{{attachment.link}}" >{{attachment.name}} <span class="btn blue_button file_type">{{attachment.type}}</span></a>
                        </div>
                        <div class="line lightest_line" ng-if="topicAttachments.length"></div>
                        <div ui-sref="topics.view.files" cos-disabled="!topic.canEdit()"class="blue_link" translate="VIEWS.TOPICS_TOPICID.LNK_ADD_MANAGE_FILES">Add/manage files</div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="side_panel_background">
    </div>

    <div ui-view></div>
</div>
